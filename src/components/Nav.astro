---
import { clsx } from 'clsx';
import { getCollection } from 'astro:content';
const objetos = (await getCollection('objetos')).sort((a,b)=> (a.data.order ?? 0) - (b.data.order ?? 0));
const { current = '/' } = Astro.props;
---
<nav class="sticky top-0 z-50 bg-white/80 backdrop-blur border-b">
  <div class="mx-auto max-w-screen-lg flex items-center justify-between px-4 py-3">
    <a href="/" class="font-semibold text-cch-azul">Química 3</a>
    <ul class="flex items-center gap-2 sm:gap-4">
      <li>
        <a class={clsx('px-2 py-1 rounded', current === '/' && 'bg-cch-azul text-white')} href="/">Inicio</a>
      </li>
      <li class="relative">
        <details class="group">
          <summary class={clsx('px-2 py-1 rounded cursor-pointer flex items-center gap-1 list-none', current.startsWith('/objetos') && 'bg-cch-azul text-white')}>
            <span>Objetos</span>
            <svg aria-hidden="true" viewBox="0 0 20 20" class="w-3 h-3 opacity-70 transition-transform group-open:rotate-180"><path fill="currentColor" d="M5.3 7.3a1 1 0 0 1 1.4 0L10 10.6l3.3-3.3a1 1 0 1 1 1.4 1.4l-4 4a1 1 0 0 1-1.4 0l-4-4a1 1 0 0 1 0-1.4Z"/></svg>
          </summary>
          <ul class="absolute right-0 mt-2 w-80 max-w-[90vw] bg-white border rounded-xl shadow-lg p-2 max-h-[70vh] overflow-auto z-50">
            {objetos.map(({ slug, data }) => (
              <li>
                <a class="block px-2 py-1.5 rounded hover:bg-slate-100" href={`/objetos/${slug}/`}>
                  <span class="font-medium">{data.title}</span>
                  {data.level && <span class="ml-1 text-xs text-slate-500">· {data.level}</span>}
                </a>
              </li>
            ))}
            <li class="mt-1 pt-1 border-t">
              <a class="block px-2 py-1.5 text-sm text-slate-600 hover:bg-slate-100 rounded" href="/objetos/">Ver todos</a>
            </li>
          </ul>
        </details>
      </li>
      <li>
        <a class={clsx('px-2 py-1 rounded', current === '/creditos' && 'bg-cch-azul text-white')} href="/creditos">Créditos</a>
      </li>
    </ul>
  </div>
</nav>

<style>
  summary::-webkit-details-marker { display: none; }
  summary::marker { display: none; }
</style>
